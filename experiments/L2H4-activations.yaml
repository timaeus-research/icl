name: L2H4-activations
method: grid
command: ["python", "icl/experiments/cov_analysis.py", "from-wandb"]
project: icl
entity: devinterp
parameters:
  analysis_config:
    parameters: 
      num_ws: 
        value: 5  # How many different ws to display
      num_xs: 
        value: 5  # How many different xs to display per w
      ws_source: 
        value: "pretrain"  # or "true"
      xs_source:
        value: "gaussian"  # currently the only supported option  
  task_config: 
    parameters:
      task_size:
        value: 4
      max_examples:
        value: 8
      num_tasks:
        values: [1, 2, 4, 8, 16, 32, 64, 128, 256, 512, 1024, 2048, 4096, 8192, 16384, 32768, 65536, 131072, 262144, 524288, 1048576]
      noise_variance:
        value: 0.125
      embed_size:
        value: 64
      mlp_size:
        value: 64
      num_heads:
        value: 4
      num_layers:
        value: 2 #[2, 4]
      model_seed:
        value: 0
      pretrain_seed:
        value: 1
      true_seed:
        value: 2
      sampling_seed:
        value: 3
  optimizer_config:
    parameters:
      lr:
        value: 0.01
  eval_batch_size:
    value: 1024
